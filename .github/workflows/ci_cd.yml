name: ETL Pipeline

on:
    workflow_dispatch:

    # schedule:
    #     - cron: '0 0 * * *'  # Runs at 12.00 AM every day


jobs:
    check-data-source:
        name: Check if raw data source is available
        runs-on: ubuntu-latest
       
        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Check if raw data is available
              run: |
                echo "üîç Checking for raw data files in ./datatable/raw/ ..."
                
                if [ -n "$(ls -A ./datatable/raw/ 2>/dev/null)" ]; then
                    echo "‚úÖ Raw data files found."
                else
                    echo "‚ùå No raw data files found in ./datatable/raw/"
                exit 1
                fi
    
    load-raw-data:
        name: Check if raw data source is available
        runs-on: ubuntu-latest
        needs: check-data-source
        if: success()

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Echo
              run: |
                echo "Hello World"


    extract-and-load:
        name: Check if raw data source is available
        runs-on: ubuntu-latest
        needs: check-data-source
        if: failure()

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Set up python 3.10
              uses: actions/setup-python@v5
              with:
                python-version: "3.10"
            
            # - name: Install dependencies
            #   run: |
            #     echo "Installing requirements ..."
            #     python -m pip install --upgrade pip
            #     pip install -r requirements.txt


            

